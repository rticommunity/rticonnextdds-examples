os: linux
dist: xenial
language: python
python: "3.7"
addons:
  apt:
    sources:
    - sourceline: "deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-9 main"
      key_url: "https://apt.llvm.org/llvm-snapshot.gpg.key"
    packages:
    - clang-format-9
    update: true
before_install:
  - git config --global clangFormat.binary clang-format-9
  - pip install Sultan scan-build
install:
  - |
    if [ -n "$RTI_MIN_PACKAGE_URL" ]; then
      resources/ci_cd/linux_install.py
    fi
script:
  - |
    if [ -n "$TRAVIS_COMMIT_RANGE" ]; then
      resources/ci_cd/linux_format.py -md -py -r $TRAVIS_COMMIT_RANGE
    else
      resources/ci_cd/linux_format.py -md -py -c $TRAVIS_COMMIT
    fi
  - |
    if [ -n "$RTI_MIN_PACKAGE_URL" ]; then
      resources/ci_cd/linux_static_analysis.py
    fi
